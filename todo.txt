refactor dfs workflow

cargo expand -p integration_tests --test state