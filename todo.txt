refactor dfs workflow
refactor expansion stuff in resource_def